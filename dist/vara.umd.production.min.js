!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}window&&(window.Vara=function(){function e(t,e,n,i){this.elementName=t,this.element=document.querySelector(t),this.fontSource=e,this.options=i,this.textItems=n,this.renderData=n,this.rendered=!1,this.fontCharacters={},this.canvasWidth=0,this.defaultOptions={fontSize:21,strokeWidth:.5,color:"#000",duration:1e3,textAlign:"left",autoAnimation:!0,queued:!0,delay:0,breakWord:!1,letterSpacing:{global:0},width:this.element.getBoundingClientRect().width},this.defaultCharacters={63:{paths:[{w:8.643798828125,h:14.231731414794922,my:22.666500004827977,mx:0,dx:0,d:"m 0,0 c -2,-6.01,5,-8.64,8,-3.98,2,4.09,-7,8.57,-7,11.85"},{w:1.103759765625,h:1.549820899963379,my:8.881500004827977,dx:0,mx:1,d:"m 0,0 a 0.7592,0.7357,0,0,1,0,0.735,0.7592,0.7357,0,0,1,-1,-0.735,0.7592,0.7357,0,0,1,1,-0.738,0.7592,0.7357,0,0,1,0,0.738 z"}],w:8.643798828125}},this.canvas=document.createElement("canvas"),this.canvas.width=800,this.canvas.height=800,this.ctx=this.canvas.getContext("2d"),this.element.appendChild(this.canvas),this.WHITESPACE=10,this.SCALEBASE=16,this.init()}var n=e.prototype;return n.init=function(){var t=this;this.normalizeOptions();var e=new XMLHttpRequest;e.open("GET",this.fontSource,!0),e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var n=JSON.parse(e.responseText);t.fontCharacters=n.c,t.fontProperties=n.p,t.preRender(),t.render()}},e.send(null)},n.preRender=function(){var t=this,e=this.createSVGNode("svg",{width:"100",height:"100"});e.style.position="absolute",e.style.zIndex="-100",e.style.opacity="0",e.style.top="0",document.body.appendChild(e);var n=this.createSVGNode("path",{d:""});e.appendChild(n),this.objectKeys(this.fontCharacters).forEach((function(e){t.fontCharacters[e].paths.forEach((function(i,r){n.setAttributeNS(null,"d",i.d),t.fontCharacters[e].paths[r].dx=n.getBoundingClientRect().x}))}))},n.render=function(){this.calculatePositions(this.renderData[1]),this.draw(this.renderData[1])},n.draw=function(t){var e=this,n=t;this.ctx.strokeStyle=n.color,this.ctx.lineWidth=n.strokeWidth,this.ctx.fillStyle="transparent",this.ctx.lineCap="round",this.ctx.lineJoin="round";var i=0,r=n.fontSize/this.SCALEBASE;n.render.forEach((function(t){var n=t.x/2;t.text.split("").forEach((function(o){var a=o.charCodeAt(0);" "===o?n+=e.WHITESPACE:e.fontCharacters[a]&&(e.ctx.save(),e.ctx.scale(r,r),e.fontCharacters[a].paths.forEach((function(r){var o=e.processPath(r.d,n+r.mx-r.dx,t.y+i+20-r.my+1);e.ctx.stroke(new Path2D(o))})),n+=e.fontCharacters[a].w,e.ctx.restore())})),i+=30}))},n.normalizeOptions=function(){var e=this;this.options=this.options||{},this.objectKeys(this.defaultOptions).forEach((function(t){void 0===e.options[t]&&(e.options[t]=e.defaultOptions[t])})),this.renderData.forEach((function(n,i){"string"==typeof n?e.renderData[i]=t({text:n},e.defaultOptions):"object"==typeof n&&e.objectKeys(e.options).forEach((function(t){void 0===n[t]&&(n[t]=e.options[t])}))})),Object.keys(this.defaultCharacters).forEach((function(t){void 0===e.fontCharacters[t]&&(e.fontCharacters[t]=e.defaultCharacters[t])}))},n.calculatePositions=function(t){var e=this,n=t,i=n.fontSize/this.SCALEBASE;if(!n.breakWord){var r=("string"==typeof n.text?[n.text]:n.text).map((function(t){return t.split(" ")})),o=[{text:"",width:0}];r.forEach((function(t){var r=0;t.forEach((function(t){var a=0;t.split("").forEach((function(t){var n=t.charCodeAt(0),r=e.fontCharacters[n]||e.fontCharacters[63],o=r.paths.reduce((function(t,e){return t+e.mx-e.dx}),0);a+=(r.w+o)*i})),o[o.length-1].width+a+r+n.x*i>n.width?(o.push({text:t,width:a}),r=0):(o[o.length-1]={text:o[o.length-1].text+t,width:o[o.length-1].width+a},r+=e.WHITESPACE*i,o[o.length-1].text+=" ")}))})),o.forEach((function(t){console.log(t.text,t.width);var e=n.x;"center"===n.textAlign&&(console.log(t.width,(n.width-t.width)/2),e=(n.width-t.width)/2),n.render?n.render.push({text:t.text,x:e,y:n.y}):n.render=[{text:t.text,x:e,y:n.y}]}))}},n.createSVGNode=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var i in e)n.setAttributeNS(null,i.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()})),e[i]);return n},n.processPath=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);var i=t.split("");return i[2]=e+1+"",i[4]=n+"",i.join("")},n.objectKeys=function(t){return Object.keys(t)},e}())}));
//# sourceMappingURL=vara.umd.production.min.js.map
